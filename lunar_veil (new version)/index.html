<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Lunar Veil Cafe ☕ — Home</title>
  <link href="https://fonts.googleapis.com/css2?family=Cinzel:wght@700&family=Inter:wght@300;400;600&display=swap" rel="stylesheet">
  <script src="https://unpkg.com/lucide@latest"></script>
  <style>
    /* Global Styles (Preserved look) */
    :root{
      --color-dark: #0A0A1F;
      --color-primary: #8A2BE2; 
      --color-secondary: #FFD700; 
      --color-accent: #2c254b; 
      --color-light: #E0E0E0; 
      --color-error: #FF6347; 
      --font-heading: 'Cinzel', serif;
      --font-body: 'Inter', sans-serif;
    }
    *{box-sizing:border-box}
    body{
      margin:0;min-height:100vh;font-family:var(--font-body);background-color:var(--color-dark);color:var(--color-light);
      background-image: radial-gradient(var(--color-accent) 1px, transparent 0), radial-gradient(var(--color-accent) 1px, transparent 0);
      background-size:80px 80px;background-position:0 0,40px 40px;
    }
    /* Header/Nav Styles */
    .header{
        background-color: var(--color-accent);
        padding: 15px 30px;
        display: flex;
        justify-content: space-between;
        align-items: center;
        box-shadow: 0 4px 12px rgba(0, 0, 0, 0.5);
    }
    .nav {
        display: flex;
        align-items: center;
        flex-grow: 1; 
        margin-left: 30px;
    }
    .nav a {
        color: var(--color-light);
        margin-right: 30px; 
        font-weight: 600;
        transition: color 0.3s;
        text-decoration: none;
        padding: 5px 0;
    }
    .nav a:hover {
        color: var(--color-secondary);
    }
    .logo{
        font-family: var(--font-heading);
        font-size: 1.5rem;
        color: var(--color-primary);
        display: flex;
        align-items: center;
    }
    .btn {
        padding: 5px 10px;
        border: none;
        border-radius: 5px;
        cursor: pointer;
        font-weight: 600;
        transition: background-color 0.3s;
        display: inline-flex;
        align-items: center;
        gap: 5px;
        margin-left: 10px; 
    }
    .btn.primary {
        background-color: var(--color-primary);
        color: var(--color-light);
    }
    .btn.primary:hover {
        background-color: #9b47e5;
    }
    /* Hero/Content Styles (Preserved look) */
    .hero {
        text-align: center;
        padding: 100px 20px 80px;
    }
    .hero h1 {
        font-family: var(--font-heading);
        font-size: 3rem;
        color: var(--color-secondary);
        margin-bottom: 20px;
    }
    .hero p {
        font-size: 1.2rem;
        color: var(--color-light);
        margin-bottom: 30px;
    }
    .menu-btn {
        background-color: var(--color-primary);
        color: var(--color-light);
        font-size: 1.1rem;
        padding: 15px 30px;
        border-radius: 8px;
        text-decoration: none;
        display: inline-flex;
        align-items: center;
        margin-top: 20px;
    }
    .featured-heading {
        font-family: var(--font-heading);
        font-size: 2rem;
        color: var(--color-primary);
        text-align: center;
        padding: 50px 0 30px;
    }
    .menu-grid {
        display: flex;
        justify-content: center;
        gap: 30px;
        padding-bottom: 50px;
    }
    .menu-item {
        background-color: #1a1a36; 
        padding: 20px;
        border-radius: 10px;
        width: 250px;
        box-shadow: 0 4px 10px rgba(0, 0, 0, 0.4);
        text-align: center;
    }
    .menu-item h3 {
        font-family: var(--font-heading);
        color: var(--color-secondary);
        margin-top: 0;
    }
    .menu-item p {
        font-size: 0.9rem;
        color: var(--color-light);
        margin-bottom: 15px;
        min-height: 40px; 
    }
    .item-footer {
        display: flex;
        justify-content: space-between;
        align-items: center;
    }
    .item-footer .price {
        font-weight: 700;
        color: var(--color-primary);
        font-size: 1.2rem;
    }
    .item-footer .add-btn {
        background-color: var(--color-primary);
        color: var(--color-light);
        padding: 8px 15px;
        border-radius: 5px;
        text-decoration: none;
    }
  </style>
</head>
<body>

  <header class="header">
    <a href="index.html" class="logo">
        <i data-lucide="moon" style="width: 24px; height: 24px;"></i>
        LUNAR VEIL CAFE ☕
    </a>
    <nav class="nav">
        <a href="index.html">Home</a>
        <a href="menu.html">Menu</a>
        <a href="transactions.html">Wallet</a>
        <a href="tracking.html">Tracking</a>
        <a href="#">Cart (<span id="cart-count">0</span>)</a>
        <a id="profile-link" href="profile.html" style="display:none; margin-left: 20px;">Profile</a> 
    </nav>
    <div id="user-status-area" style="color: var(--color-light); font-weight: 600; white-space: nowrap;">
        Loading Status...
    </div>
  </header>

  <main>
    <section class="hero">
        <h1>CELESTIAL BREWS & COSMIC BITES</h1>
        <p>Experience the otherworldly taste of the Lunar Veil Cafe.</p>
        <a href="menu.html" class="menu-btn">
            View Full Menu <i data-lucide="arrow-right" style="width: 20px; height: 20px; margin-left: 10px;"></i>
        </a>
    </section>

    <h2 class="featured-heading">FEATURED ITEMS</h2>
    <section class="menu-grid">
        <div class="menu-item">
            <h3>DOUBLE SHOT VEIL</h3>
            <p>Potent double shot of our signature blend.</p>
            <div class="item-footer">
                <span class="price">$5.50</span>
                <button class="btn primary add-btn">Add</button>
            </div>
        </div>
        <div class="menu-item">
            <h3>MIDNIGHT ESPRESSO</h3>
            <p>Dark roast with a velvet finish, single shot.</p>
            <div class="item-footer">
                <span class="price">$4.50</span>
                <button class="btn primary add-btn">Add</button>
            </div>
        </div>
        <div class="menu-item">
            <h3>NOVA AMERICANO</h3>
            <p>Espresso diluted with hot water for a smooth finish.</p>
            <div class="item-footer">
                <span class="price">$4.00</span>
                <button class="btn primary add-btn">Add</button>
            </div>
        </div>
    </section>
  </main>

<script>
    const authUrl = 'auth.php'; 

    // Function to handle logout
    async function handleLogout() {
        await fetch(authUrl, { 
            method: 'POST', 
            body: JSON.stringify({ action: 'logout' }), 
            headers: { 'Content-Type': 'application/json' } 
        });
        window.location.href = 'index.html'; 
    }

    // Function to check login status and update the header
    async function updateHeaderStatus() {
        const statusDiv = document.getElementById('user-status-area');
        const profileLink = document.getElementById('profile-link');
        
        try {
            const response = await fetch(authUrl, {
                method: 'POST', body: JSON.stringify({ action: 'status' }),
                headers: { 'Content-Type': 'application/json' }
            });
            const data = await response.json();

            if (data.isLoggedIn) {
                // User is logged in: Show Name, Role, Balance, and Logout button
                const formattedBalance = parseFloat(data.balance).toFixed(2);
                
                // Construct the dynamic content to exactly match the screenshot look
                statusDiv.innerHTML = `
                    Welcome, <b>${data.username}</b>! | 
                    Role: <b>${data.role.toUpperCase()}</b> | 
                    Balance: <b>$${formattedBalance}</b> 
                    <button id="logout-btn" class="btn primary">
                        <i data-lucide="log-out" style="width: 18px; height: 18px;"></i> Logout
                    </button>
                `;
                
                // Show the Profile link in the Nav bar
                profileLink.style.display = 'inline-block';
                
                // Attach the logout handler
                document.getElementById('logout-btn').addEventListener('click', handleLogout);

            } else {
                // User is logged out: Show Login/Register link
                statusDiv.innerHTML = `
                    <a href="login.html" style="color: var(--color-secondary); font-weight: 600;">Login / Register</a>
                `;

                // Hide the Profile link
                profileLink.style.display = 'none';
            }
        } catch (error) {
            console.error("Error fetching status:", error);
            statusDiv.innerHTML = 'Status Check Failed';
        }
        
        lucide.createIcons();
    }
    
    document.addEventListener('DOMContentLoaded', updateHeaderStatus);
</script>

</body>
</html>